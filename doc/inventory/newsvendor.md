# 新聞売り子問題

新聞売り子問題（Newsvendor Problem）は、古典的な確率的在庫モデルの一つである。

[Arrow et al. (1951)](https://doi.org/10.2307/1906813)
[Chen et al. (2016)](https://doi.org/10.1111/deci.12215) は新聞売り子問題の最新研究をレビューしている。最近では、データ駆動新聞売り子問題（Data-Driven Newsvendor Problem）に関する研究が行われている。

新聞売り子が毎日新聞を仕入れ、販売する問題を考える。新聞 1 部の仕入れ価格を $c$、販売価格を $r$、残存価額を $v$、欠品費用を $p$、保管費用を $h$ とする。新聞の需要 $D$ は正規分布 $N(\mu, \sigma^2)$ に従い、$\mu$ と $\sigma$ は既知である。新聞売り子はどれだけの新聞を仕入れればよいか。

ある日、新聞売り子が $S$ 部の新聞を仕入れ、需要 $D$ が $d$ であったとする。このとき、新聞売り子の利益は以下のように表される。

$$
\Pi(S, d) = r \min\{d, S\} - cS + v \max\{0, S - d\} \\
- h \max\{0, S - d\} - p \max\{0, d - S\}
$$

第一項は販売利益、第二項は仕入れコスト、第三項は残存価値、第四項は保管コスト、第五項は欠品コストである。

以下は、$\max\{0, x\} = x^+$ を用いて書き換えた形である。整理すると、利益は以下のように表される。

$$
\Pi(S, d) = r \min\{d, S\} - cS + (v - h) (S - d)^+ - p (d - S)^+
$$

第一項を以下のように書き換えることができる。

$$
r \min\{d, S\} = r d - r (d - S)^+
$$

:::{note}
- $d < S$ の場合、$r \min\{d, S\} = r d$ となる。
- $d >= S$ の場合、$r \min\{d, S\} = r d - r(d - S) = r S$ となる。
:::

従って、利益は

$$
\Pi(S, d) = r d - cS + (v- h) (S - d)^+ - (p + r) (d - S)^+
$$

利益の最大化とコストの最小化は同じである。したがって、新聞売り子問題は以下のように定式化できる。

$$
g(S, d) = cS - rd + (h - v) (S - d)^+ + (p + r) (d - S)^+
$$